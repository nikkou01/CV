<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DataTables Implementation</title>
    
    <!-- Bootstrap 5 CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    
    <!-- DataTables CSS -->
    <link rel="stylesheet" href="https://cdn.datatables.net/1.13.7/css/dataTables.bootstrap5.min.css">
    <link rel="stylesheet" href="https://cdn.datatables.net/buttons/2.4.2/css/buttons.bootstrap5.min.css">
    <link rel="stylesheet" href="https://cdn.datatables.net/select/1.7.0/css/select.bootstrap5.min.css">
    
    <style>
        body {
            padding: 20px;
            background-color: #f8f9fa;
        }
        
        .container-fluid {
            max-width: 1400px;
            margin: 0 auto;
        }
        
        .dataTables_wrapper .dataTables_length {
            float: left;
            margin-bottom: 10px;
        }
        
        .dataTables_wrapper .dataTables_info {
            float: left;
            clear: left;
            padding-top: 8px;
        }
        
        .dataTables_wrapper .dataTables_paginate {
            float: none;
            text-align: center;
            margin-top: -40px;
            margin-bottom: 20px;
        }
        
        .dataTables_wrapper .dataTables_filter {
            display: none;
        }
        
        .column-search-row input {
            width: 100%;
            padding: 5px;
            box-sizing: border-box;
        }
        
        .column-search-row th {
            padding: 8px !important;
        }
        
        table.dataTable thead th {
            border-bottom: 1px solid #dee2e6;
        }
        
        .btn-delete {
            margin-bottom: 15px;
        }
        
        .column-toggle {
            margin-bottom: 15px;
        }
        
        .column-toggle label {
            margin-right: 15px;
            cursor: pointer;
        }
        
        .tab-content {
            background: white;
            padding: 20px;
            border-radius: 5px;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
        }
        
        .nav-tabs {
            margin-bottom: 20px;
        }
        
        h1 {
            margin-bottom: 30px;
            color: #333;
        }
        
        table.dataTable tbody tr.selected {
            background-color: #b0bed9 !important;
        }
    </style>
</head>
<body>
    <div class="container-fluid">
        <h1 class="text-center">DataTables Implementation</h1>
        
        <!-- Tabs Navigation -->
        <ul class="nav nav-tabs" id="myTab" role="tablist">
            <li class="nav-item" role="presentation">
                <button class="nav-link active" id="tab1-tab" data-bs-toggle="tab" data-bs-target="#tab1" type="button" role="tab">Table View 1</button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="tab2-tab" data-bs-toggle="tab" data-bs-target="#tab2" type="button" role="tab">Table View 2</button>
            </li>
        </ul>
        
        <!-- Tabs Content -->
        <div class="tab-content" id="myTabContent">
            <!-- Tab 1 -->
            <div class="tab-pane fade show active" id="tab1" role="tabpanel">
                <div class="mb-3">
                    <button id="deleteBtn1" class="btn btn-danger btn-delete">Delete Selected Row</button>
                </div>
                
                <div class="column-toggle mb-3">
                    <strong>Toggle Columns:</strong><br>
                    <label><input type="checkbox" class="toggle-vis" data-table="1" data-column="0" checked> Name</label>
                    <label><input type="checkbox" class="toggle-vis" data-table="1" data-column="1" checked> Position</label>
                    <label><input type="checkbox" class="toggle-vis" data-table="1" data-column="2" checked> Office</label>
                    <label><input type="checkbox" class="toggle-vis" data-table="1" data-column="3" checked> Nationality</label>
                    <label><input type="checkbox" class="toggle-vis" data-table="1" data-column="4" checked> Age</label>
                    <label><input type="checkbox" class="toggle-vis" data-table="1" data-column="5" checked> Start Date</label>
                    <label><input type="checkbox" class="toggle-vis" data-table="1" data-column="6" checked> Salary</label>
                </div>
                
                <table id="example1" class="table table-striped table-bordered" style="width:100%">
                    <thead>
                        <tr>
                            <th>Name</th>
                            <th>Position</th>
                            <th>Office</th>
                            <th>Nationality</th>
                            <th>Age</th>
                            <th>Start Date</th>
                            <th>Salary</th>
                        </tr>
                        <tr class="column-search-row">
                            <th><input type="text" placeholder="Search Name" /></th>
                            <th><input type="text" placeholder="Search Position" /></th>
                            <th><input type="text" placeholder="Search Office" /></th>
                            <th><input type="text" placeholder="Search Nationality" /></th>
                            <th><input type="text" placeholder="Search Age" /></th>
                            <th><input type="text" placeholder="Search Date" /></th>
                            <th><input type="text" placeholder="Search Salary" /></th>
                        </tr>
                    </thead>
                </table>
            </div>
            
            <!-- Tab 2 -->
            <div class="tab-pane fade" id="tab2" role="tabpanel">
                <div class="mb-3">
                    <button id="deleteBtn2" class="btn btn-danger btn-delete">Delete Selected Row</button>
                </div>
                
                <div class="column-toggle mb-3">
                    <strong>Toggle Columns:</strong><br>
                    <label><input type="checkbox" class="toggle-vis" data-table="2" data-column="0" checked> Name</label>
                    <label><input type="checkbox" class="toggle-vis" data-table="2" data-column="1" checked> Position</label>
                    <label><input type="checkbox" class="toggle-vis" data-table="2" data-column="2" checked> Office</label>
                    <label><input type="checkbox" class="toggle-vis" data-table="2" data-column="3" checked> Nationality</label>
                    <label><input type="checkbox" class="toggle-vis" data-table="2" data-column="4" checked> Age</label>
                    <label><input type="checkbox" class="toggle-vis" data-table="2" data-column="5" checked> Start Date</label>
                    <label><input type="checkbox" class="toggle-vis" data-table="2" data-column="6" checked> Salary</label>
                </div>
                
                <table id="example2" class="table table-striped table-bordered" style="width:100%">
                    <thead>
                        <tr>
                            <th>Name</th>
                            <th>Position</th>
                            <th>Office</th>
                            <th>Nationality</th>
                            <th>Age</th>
                            <th>Start Date</th>
                            <th>Salary</th>
                        </tr>
                        <tr class="column-search-row">
                            <th><input type="text" placeholder="Search Name" /></th>
                            <th><input type="text" placeholder="Search Position" /></th>
                            <th><input type="text" placeholder="Search Office" /></th>
                            <th><input type="text" placeholder="Search Nationality" /></th>
                            <th><input type="text" placeholder="Search Age" /></th>
                            <th><input type="text" placeholder="Search Date" /></th>
                            <th><input type="text" placeholder="Search Salary" /></th>
                        </tr>
                    </thead>
                </table>
            </div>
        </div>
    </div>
    
    <!-- jQuery -->
    <script src="https://code.jquery.com/jquery-3.7.0.min.js"></script>
    
    <!-- Bootstrap 5 JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    
    <!-- DataTables JS -->
    <script src="https://cdn.datatables.net/1.13.7/js/jquery.dataTables.min.js"></script>
    <script src="https://cdn.datatables.net/1.13.7/js/dataTables.bootstrap5.min.js"></script>
    <script src="https://cdn.datatables.net/select/1.7.0/js/dataTables.select.min.js"></script>
    
    <script>
        $(document).ready(function() {
            // Define nationality data mapping
            const nationalityMap = {
                'Tokyo': 'Japanese',
                'Singapore': 'Singaporean',
                'London': 'British',
                'New York': 'American',
                'San Francisco': 'American',
                'Edinburgh': 'Scottish',
                'Sydney': 'Australian'
            };
            
            // Common DataTable configuration
            function initDataTable(tableId) {
                var table = $(tableId).DataTable({
                    ajax: {
                        url: 'https://datatables.net/examples/ajax/data/arrays.txt',
                        dataSrc: function(json) {
                            // Add nationality column based on office
                            return json.data.map(function(row) {
                                var office = row[2];
                                var nationality = nationalityMap[office] || 'International';
                                // Insert nationality after office (position 3)
                                row.splice(3, 0, nationality);
                                return row;
                            });
                        }
                    },
                    columns: [
                        { title: "Name" },
                        { title: "Position" },
                        { title: "Office" },
                        { title: "Nationality" },
                        { title: "Age" },
                        { title: "Start Date" },
                        { title: "Salary" }
                    ],
                    select: {
                        style: 'single'
                    },
                    dom: 'lrtip',
                    pageLength: 10,
                    language: {
                        lengthMenu: "_MENU_ entries per page",
                        info: "Showing _START_ to _END_ of _TOTAL_ entries",
                        paginate: {
                            first: "First",
                            last: "Last",
                            next: "Next",
                            previous: "Previous"
                        }
                    },
                    orderCellsTop: true,
                    fixedHeader: true
                });
                
                // Individual column searching
                $(tableId + ' thead tr:eq(1) th').each(function(i) {
                    $('input', this).on('keyup change', function() {
                        if (table.column(i).search() !== this.value) {
                            table.column(i).search(this.value).draw();
                        }
                    });
                });
                
                return table;
            }
            
            // Initialize both tables
            var table1 = initDataTable('#example1');
            var table2 = initDataTable('#example2');
            
            // Delete selected row functionality for Table 1
            $('#deleteBtn1').on('click', function() {
                var selectedRow = table1.rows('.selected');
                if (selectedRow.length > 0) {
                    if (confirm('Are you sure you want to delete the selected row?')) {
                        selectedRow.remove().draw();
                    }
                } else {
                    alert('Please select a row to delete');
                }
            });
            
            // Delete selected row functionality for Table 2
            $('#deleteBtn2').on('click', function() {
                var selectedRow = table2.rows('.selected');
                if (selectedRow.length > 0) {
                    if (confirm('Are you sure you want to delete the selected row?')) {
                        selectedRow.remove().draw();
                    }
                } else {
                    alert('Please select a row to delete');
                }
            });
            
            // Column visibility toggle
            $('.toggle-vis').on('change', function(e) {
                var tableNum = $(this).data('table');
                var column = $(this).data('column');
                var table = tableNum === 1 ? table1 : table2;
                
                // Toggle the visibility
                var col = table.column(column);
                col.visible(!col.visible());
            });
            
            // Reinitialize table when switching tabs to ensure proper rendering
            $('button[data-bs-toggle="tab"]').on('shown.bs.tab', function(e) {
                $.fn.dataTable.tables({ visible: true, api: true }).columns.adjust();
            });
        });
    </script>
</body>
</html>
